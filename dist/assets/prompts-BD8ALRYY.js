import{e as G,c as J,d as o,r as n,h,j as e,C as v,i as _,k as z,f as C,l as K}from"./index-BiTP6UeF.js";import{u as Y}from"./useSuspenseQuery-BI5dw9cZ.js";import{B as a}from"./button-RNOw0Kg4.js";import{I as g}from"./input-C8zM_rjF.js";import{L as c}from"./label-BUooFWRZ.js";import{T as A,S as Z}from"./textarea-YkGIn2mW.js";import{D as ee,a as se,b as te,c as ae,d as le,e as ie,f as re}from"./dialog-CkvU02Kn.js";import{R as E}from"./refresh-cw-aD6uxtSl.js";import{P as ne}from"./plus-Duac9OgE.js";import{M as oe}from"./message-square-xWUg4nPR.js";import{C as ce}from"./check-tE-Z_oDg.js";import{X as de}from"./index-DDYpCHIR.js";import{C as me}from"./chevron-up-CiPoKxbo.js";import{C as xe}from"./chevron-down-DfK4IzMz.js";import{P as pe}from"./pencil-H-izHkUJ.js";import{T as he}from"./trash-2-Cg89AqxP.js";import{C as ge}from"./copy-BYoSSq7T.js";import"./index-eoGaCaxS.js";import"./Combination-DgyOTBSr.js";const ue=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],je=G("code-xml",ue),F=[{name:"{{chatName}}",description:"Name of the person you're chatting with"},{name:"{{conversationHistory}}",description:"Recent message history"},{name:"{{lastMessageText}}",description:"The last message received"},{name:"{{contactContext}}",description:"Contact information from your database"},{name:"{{customContext}}",description:"Any custom context you provide"},{name:"{{platform}}",description:"Instagram, WhatsApp, etc."},{name:"{{messageCount}}",description:"Number of messages in conversation"}];function Me(){const{data:y}=Y(J(o.prompts.listPrompts,{})),[L,u]=n.useState(!1),[M,j]=n.useState(null),[R,N]=n.useState(null),[f,w]=n.useState({}),[l,d]=n.useState({name:"",title:"",description:""}),[P,D]=n.useState(!1),[$,I]=n.useState(null),[m,k]=n.useState(!1),H=h(o.prompts.createPrompt),q=h(o.prompts.updatePrompt),B=h(o.prompts.deletePrompt),O=h(o.prompts.initializeDefaultPrompts),U=async()=>{if(!l.name||!l.title||!l.description){alert("Please fill in all fields");return}try{await H(l),d({name:"",title:"",description:""}),u(!1)}catch(s){alert(s.message||"Failed to create prompt")}},V=s=>{j(s._id),N(s._id),w(t=>({...t,[s._id]:{name:s.name,title:s.title,description:s.description}}))},Q=async s=>{const t=f[s];if(!t?.name||!t?.title||!t?.description){alert("Please fill in all fields");return}D(!0);try{await q({id:s,...t}),j(null),I(s),setTimeout(()=>I(null),2e3)}catch(i){alert(i.message||"Failed to update prompt")}finally{D(!1)}},X=async s=>{if(confirm("Are you sure you want to delete this prompt? This action cannot be undone."))try{await B({id:s})}catch(t){alert(t.message||"Failed to delete prompt")}},S=async()=>{k(!0);try{const s=await O();s.created.length>0?alert(`Created ${s.created.length} default prompt(s): ${s.created.join(", ")}`):alert("All default prompts already exist")}catch(s){alert(s.message||"Failed to initialize defaults")}finally{k(!1)}},x=(s,t,i)=>{w(p=>({...p,[s]:{...p[s]||{name:"",title:"",description:""},[t]:i}}))},T=s=>{navigator.clipboard.writeText(s)},W=(s,t)=>{const i=f[s]?.description||"";x(s,"description",i+t)};return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6 max-w-5xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-100",children:"AI Prompts"}),e.jsx("p",{className:"text-slate-400 mt-1",children:"Manage and customize AI prompt templates used throughout the app"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{variant:"outline",onClick:S,disabled:m,className:"gap-2 bg-slate-800 border-slate-600 text-slate-300 hover:bg-slate-700 hover:text-slate-100",children:[e.jsx(E,{className:`h-4 w-4 ${m?"animate-spin":""}`}),"Initialize Defaults"]}),e.jsxs(ee,{open:L,onOpenChange:u,children:[e.jsx(se,{asChild:!0,children:e.jsxs(a,{className:"gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"New Prompt"]})}),e.jsxs(te,{className:"bg-slate-800 border-slate-700 text-slate-100 max-w-2xl",children:[e.jsxs(ae,{children:[e.jsx(le,{children:"Create New Prompt"}),e.jsxs(ie,{className:"text-slate-400",children:["Create a new AI prompt template. Use template variables like ","{{chatName}}"," for dynamic content."]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-slate-300",children:"Name (unique key)"}),e.jsx(g,{placeholder:"reply-suggestions",value:l.name,onChange:s=>d({...l,name:s.target.value}),className:"bg-slate-900 border-slate-600 text-slate-100 mt-1"})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-slate-300",children:"Display Title"}),e.jsx(g,{placeholder:"AI Reply Suggestions",value:l.title,onChange:s=>d({...l,title:s.target.value}),className:"bg-slate-900 border-slate-600 text-slate-100 mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-slate-300",children:"Prompt Template"}),e.jsx(A,{placeholder:"Enter your prompt template here...",value:l.description,onChange:s=>d({...l,description:s.target.value}),className:"bg-slate-900 border-slate-600 text-slate-100 mt-1 min-h-[300px] font-mono text-sm"})]})]}),e.jsxs(re,{children:[e.jsx(a,{variant:"outline",onClick:()=>u(!1),className:"bg-slate-700 border-slate-600 text-slate-300 hover:bg-slate-600",children:"Cancel"}),e.jsx(a,{onClick:U,children:"Create Prompt"})]})]})]})]})]}),e.jsxs(v,{className:"bg-slate-800/30 border-slate-700",children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4 text-blue-400"}),e.jsx(z,{className:"text-sm text-slate-300",children:"Template Variables"})]})}),e.jsxs(C,{children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(s=>e.jsxs("button",{onClick:()=>T(s.name),className:"group relative px-2 py-1 bg-slate-900 border border-slate-600 rounded text-xs font-mono text-blue-400 hover:bg-slate-800 hover:border-blue-500 transition-colors",title:s.description,children:[s.name,e.jsx("span",{className:"absolute -top-8 left-1/2 -translate-x-1/2 px-2 py-1 bg-slate-700 text-slate-200 text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:s.description})]},s.name))}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Click to copy. Hover for description."})]})]}),y.length===0?e.jsx(v,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs(C,{className:"py-12 text-center",children:[e.jsx(oe,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No prompts yet"}),e.jsxs(a,{onClick:S,disabled:m,children:[e.jsx(E,{className:`h-4 w-4 mr-2 ${m?"animate-spin":""}`}),"Initialize Default Prompts"]})]})}):e.jsx("div",{className:"space-y-4",children:y.map(s=>{const t=M===s._id,i=R===s._id,p=$===s._id,b=f[s._id]||{name:s.name,title:s.title,description:s.description};return e.jsxs(v,{className:`bg-slate-800/50 border-slate-700 transition-all ${t?"ring-2 ring-blue-500/50":""}`,children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:t?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-slate-400 text-xs",children:"Name"}),e.jsx(g,{value:b.name,onChange:r=>x(s._id,"name",r.target.value),className:"bg-slate-900 border-slate-600 text-slate-100 mt-1"})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-slate-400 text-xs",children:"Title"}),e.jsx(g,{value:b.title,onChange:r=>x(s._id,"title",r.target.value),className:"bg-slate-900 border-slate-600 text-slate-100 mt-1"})]})]}):e.jsxs("div",{className:"cursor-pointer",onClick:()=>N(i?null:s._id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{className:"text-slate-100",children:s.title}),p&&e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-xs",children:[e.jsx(ce,{className:"h-3 w-3"}),"Saved"]})]}),e.jsxs(K,{className:"mt-1",children:[e.jsx("code",{className:"text-xs bg-slate-900 text-slate-400 px-2 py-0.5 rounded",children:s.name}),e.jsxs("span",{className:"text-slate-500 ml-3 text-xs",children:["Updated ",new Date(s.updatedAt).toLocaleDateString()]})]})]})}),e.jsx("div",{className:"flex items-center gap-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>Q(s._id),disabled:P,className:"text-green-400 hover:text-green-300 hover:bg-green-900/20",children:e.jsx(Z,{className:`h-4 w-4 ${P?"animate-pulse":""}`})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>j(null),className:"text-slate-400 hover:text-slate-300",children:e.jsx(de,{className:"h-4 w-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>N(i?null:s._id),className:"text-slate-400 hover:text-slate-300",children:i?e.jsx(me,{className:"h-4 w-4"}):e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>V(s),className:"text-slate-400 hover:text-slate-300",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>X(s._id),className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:e.jsx(he,{className:"h-4 w-4"})})]})})]})}),(i||t)&&e.jsx(C,{className:"pt-0",children:t?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"text-xs text-slate-500 mr-2",children:"Insert:"}),F.map(r=>e.jsx("button",{onClick:()=>W(s._id,r.name),className:"px-1.5 py-0.5 bg-slate-900 border border-slate-700 rounded text-xs font-mono text-blue-400 hover:bg-slate-800 hover:border-blue-500 transition-colors",title:r.description,children:r.name.replace(/\{\{|\}\}/g,"")},r.name))]}),e.jsx(A,{value:b.description,onChange:r=>x(s._id,"description",r.target.value),className:"bg-slate-900 border-slate-600 text-slate-100 min-h-[500px] font-mono text-sm leading-relaxed"})]}):e.jsxs("div",{className:"relative",children:[e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>T(s.description),className:"absolute top-2 right-2 text-slate-500 hover:text-slate-300",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("pre",{className:"text-sm text-slate-300 whitespace-pre-wrap font-mono bg-slate-900/50 p-4 rounded-lg border border-slate-700 max-h-[400px] overflow-auto",children:s.description})]})})]},s._id)})})]})})}export{Me as component};
