import{u as j,a as b,r,b as S,c as v,d as w,j as e,C as N,L as I}from"./index-BiTP6UeF.js";import{B as g}from"./button-RNOw0Kg4.js";import{I as m}from"./input-C8zM_rjF.js";import{L as h}from"./label-BUooFWRZ.js";import"./index-eoGaCaxS.js";function P(){const{signIn:x}=j(),l=b(),[i,o]=r.useState(null),[n,c]=r.useState(!1),[d,p]=r.useState(!1),{data:u}=S(v(w.auth.currentUser,{}));r.useEffect(()=>{if(typeof window<"u"){const t=Object.keys(localStorage).filter(s=>s.includes("convex")||s.includes("auth")||s.includes("token"));console.log("=== Auth Debug Info ==="),console.log("LocalStorage auth-related keys:",t),t.forEach(s=>{const a=localStorage.getItem(s);console.log(`${s}:`,a?`${a.substring(0,50)}...`:"null")}),console.log("======================")}},[]),r.useEffect(()=>{u&&d&&(console.log("User authenticated, redirecting to dashboard"),l({to:"/"}))},[u,d,l]);const f=()=>{typeof window<"u"&&(console.log("Clearing all auth-related localStorage items..."),Object.keys(localStorage).filter(s=>s.includes("convex")||s.includes("auth")||s.includes("token")).forEach(s=>{console.log("Removing:",s),localStorage.removeItem(s)}),console.log("Auth storage cleared! Please refresh the page."),o("Auth storage cleared! Please refresh the page and try again."))},y=async t=>{t.preventDefault(),o(null),c(!0);const s=new FormData(t.currentTarget);try{console.log("Attempting sign in..."),await x("password",s),console.log("Sign in successful, waiting for auth state to update..."),p(!0)}catch(a){console.error("Sign in error:",a),o(a instanceof Error?a.message:"Sign in failed"),c(!1)}};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 px-4",children:e.jsxs(N,{className:"w-full max-w-md space-y-6 p-8",children:[e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Sign In"}),e.jsx("p",{className:"text-gray-500",children:"Enter your credentials to access your dashboard"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"email",children:"Email"}),e.jsx(m,{id:"email",name:"email",type:"email",placeholder:"your@email.com",required:!0,disabled:n})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"password",children:"Password"}),e.jsx(m,{id:"password",name:"password",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0,disabled:n})]}),e.jsx("input",{type:"hidden",name:"flow",value:"signIn"}),i&&e.jsx("div",{className:"rounded-md bg-red-50 p-3 text-sm text-red-800",children:i}),e.jsx(g,{type:"submit",className:"w-full",disabled:n,children:n?"Signing in...":"Sign In"})]}),e.jsx("div",{className:"border-t pt-4 text-center text-sm text-gray-500",children:e.jsxs("p",{children:["Need to create an account?"," ",e.jsx(I,{to:"/sign-up",className:"text-blue-600 hover:underline font-medium",children:"Sign up here"})]})}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx(g,{type:"button",variant:"outline",onClick:f,className:"w-full text-xs",children:"ðŸ”§ Clear Auth Storage (Debug)"}),e.jsx("p",{className:"mt-2 text-xs text-gray-500 text-center",children:"Click this if you're seeing authentication errors"})]})]})})}export{P as component};
